# -*- coding: utf-8 -*-
"""companies dataset

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/13RPdHmuP3JSoY85ijByWjByhp77wvs35
"""

import pandas as pd
import numpy as np

df = pd.read_csv('/content/companies_sorted.csv')

df.info()
print(df.head())
print(df.describe(include='all'))
print(df.shape)
print(df.columns)
print(df.isnull().sum())

df = df.drop(columns=['Unnamed: 0'], errors='ignore')

df = df.rename(columns={
    'year founded': 'FoundedYear',
    'size range': 'SizeRange',
    'linkedin url': 'LinkedInURL',
    'current employee estimate': 'CurrentEmployees',
    'total employee estimate': 'TotalEmployees'
})

string_cols = ['name', 'domain', 'industry', 'SizeRange', 'locality', 'country']
for col in string_cols:
    if col in df.columns:
        df[col] = df[col].astype(str).str.strip().str.title()
        df[col].replace({'Nan': np.nan}, inplace=True)
        df[col].fillna('Unknown', inplace=True)

if 'FoundedYear' in df.columns:
    df['FoundedYear'] = pd.to_datetime(df['FoundedYear'], format='%Y', errors='coerce').dt.to_period('Y').dt.to_timestamp()
    df['FoundedYear'].fillna(pd.Timestamp('1900-01-01'), inplace=True)

numeric_cols = ['CurrentEmployees', 'TotalEmployees']
for col in numeric_cols:
    if col in df.columns:
        df[col] = pd.to_numeric(df[col], errors='coerce').astype('Int64')
        df[col].fillna(0, inplace=True)


for col in df.select_dtypes(include=['float', 'int']).columns:
    df[col].fillna(0, inplace=True)


key_cols = ['name', 'domain']
existing_keys = [col for col in key_cols if col in df.columns]
if existing_keys:
    df.drop_duplicates(subset=existing_keys, keep='first', inplace=True)

df.to_csv('companies_cleaned.csv', index=False)
print(df.head())
print(df.isnull().sum())
print(df.dtypes)
df.info()